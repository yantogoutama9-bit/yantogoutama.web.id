<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Master ERP (Offline)</title>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0bb56a" />

  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">ERP</div>
      <div>
        <div class="title">Master ERP</div>
        <div class="subtitle">Offline + PWA ‚Ä¢ Purchasing ‚Ä¢ Inventory ‚Ä¢ Production ‚Ä¢ Sales ‚Ä¢ Finance</div>
      </div>
    </div>

    <div class="top-actions">
      <button class="btn ghost" id="btnBackupJson">Backup JSON</button>
      <label class="btn ghost" for="fileImportJson" style="cursor:pointer;">Import JSON</label>
      <input id="fileImportJson" type="file" accept="application/json" hidden />
      <button class="btn" id="btnExportCsv">Export CSV</button>
      <button class="btn danger" id="btnResetAll">Reset Data</button>
    </div>
  </header>

  <main class="wrap">
    <section class="grid">
      <aside class="sidebar card">
        <div class="tabs" id="tabs">
          <button class="tab active" data-tab="dashboard">Dashboard</button>
          <button class="tab" data-tab="master">Master Data</button>
          <button class="tab" data-tab="purchasing">Purchasing</button>
          <button class="tab" data-tab="inventory">Inventory</button>
          <button class="tab" data-tab="production">Production</button>
          <button class="tab" data-tab="sales">Sales</button>
          <button class="tab" data-tab="shipping">Shipping</button>
          <button class="tab" data-tab="returns">Returns</button>
          <button class="tab" data-tab="finance">Finance</button>
          <button class="tab" data-tab="reports">Reports</button>
        </div>

        <div class="hint">
          <div class="hint-title">üí° Cara Cepat Mulai</div>
          <ol>
            <li>Masuk <b>Master Data</b> ‚Üí buat <b>Vendor, Customer, Item</b></li>
            <li><b>Purchasing</b> ‚Üí buat PO ‚Üí <b>Receive</b> (stok kain masuk)</li>
            <li><b>Production</b> ‚Üí buat WO (consume bahan ‚Üí output baju)</li>
            <li><b>Sales</b> ‚Üí buat SO ‚Üí <b>Shipping</b> kirim</li>
            <li><b>Finance</b> otomatis ngikut transaksi + bisa input manual</li>
          </ol>
        </div>
      </aside>

      <section class="content">
        <!-- DASHBOARD -->
        <div class="panel card active" data-panel="dashboard">
          <div class="panel-head">
            <h2>üìä Dashboard</h2>
            <div class="muted">Ringkasan bisnis realtime (offline)</div>
          </div>

          <div class="kpi-row">
            <div class="kpi">
              <div class="kpi-label">Stok Item</div>
              <div class="kpi-value" id="kpiTotalItems">0</div>
              <div class="kpi-note">Total SKU</div>
            </div>
            <div class="kpi">
              <div class="kpi-label">Nilai Stok</div>
              <div class="kpi-value" id="kpiStockValue">Rp 0</div>
              <div class="kpi-note">Estimasi (avg cost)</div>
            </div>
            <div class="kpi">
              <div class="kpi-label">Sales (Bulan Ini)</div>
              <div class="kpi-value" id="kpiSalesMonth">Rp 0</div>
              <div class="kpi-note">Total invoice</div>
            </div>
            <div class="kpi">
              <div class="kpi-label">Profit (Bulan Ini)</div>
              <div class="kpi-value" id="kpiProfitMonth">Rp 0</div>
              <div class="kpi-note">Income - Expense</div>
            </div>
          </div>

          <div class="two-col">
            <div class="card inner">
              <h3>üìà Laba Rugi (Sederhana)</h3>
              <div class="chart" id="chartPnL"></div>
              <div class="small muted">Catatan: ini versi master template (bisa lo upgrade jadi akuntansi full).</div>
            </div>
            <div class="card inner">
              <h3>üßæ Aktivitas Terakhir</h3>
              <div class="list" id="recentActivity"></div>
            </div>
          </div>
        </div>

        <!-- MASTER DATA -->
        <div class="panel card" data-panel="master">
          <div class="panel-head">
            <h2>üß© Master Data</h2>
            <div class="muted">Vendor ‚Ä¢ Customer ‚Ä¢ Items</div>
          </div>

          <div class="three-col">
            <div class="card inner">
              <h3>üè≠ Vendor</h3>
              <form id="formVendor" class="form">
                <div class="row">
                  <label>Nama Vendor</label>
                  <input required name="name" placeholder="Contoh: Supplier Kain A" />
                </div>
                <div class="row">
                  <label>Telepon</label>
                  <input name="phone" placeholder="08xxxx" />
                </div>
                <div class="row">
                  <label>Email</label>
                  <input name="email" placeholder="vendor@email.com" />
                </div>
                <button class="btn" type="submit">Tambah Vendor</button>
              </form>
              <div class="table-wrap">
                <table class="table" id="tblVendors">
                  <thead><tr><th>Nama</th><th>Kontak</th><th></th></tr></thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>

            <div class="card inner">
              <h3>üßë‚Äçüíº Customer</h3>
              <form id="formCustomer" class="form">
                <div class="row">
                  <label>Nama Customer</label>
                  <input required name="name" placeholder="Contoh: Toko Baju XYZ" />
                </div>
                <div class="row">
                  <label>Telepon</label>
                  <input name="phone" placeholder="08xxxx" />
                </div>
                <div class="row">
                  <label>Email</label>
                  <input name="email" placeholder="customer@email.com" />
                </div>
                <button class="btn" type="submit">Tambah Customer</button>
              </form>
              <div class="table-wrap">
                <table class="table" id="tblCustomers">
                  <thead><tr><th>Nama</th><th>Kontak</th><th></th></tr></thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>

            <div class="card inner">
              <h3>üì¶ Items</h3>
              <form id="formItem" class="form">
                <div class="row">
                  <label>Nama Item</label>
                  <input required name="name" placeholder="Contoh: Kain Katun 30s / Baju Jadi" />
                </div>
                <div class="row">
                  <label>Tipe</label>
                  <select name="type">
                    <option value="raw">Raw Material (Bahan)</option>
                    <option value="wip">WIP (Proses)</option>
                    <option value="fg">Finished Goods (Produk Jadi)</option>
                    <option value="service">Service</option>
                  </select>
                </div>
                <div class="row">
                  <label>Satuan</label>
                  <input name="uom" placeholder="meter / pcs / roll" value="pcs" />
                </div>
                <div class="row">
                  <label>Harga Jual Default</label>
                  <input name="sellPrice" type="number" min="0" step="100" value="0" />
                </div>
                <button class="btn" type="submit">Tambah Item</button>
              </form>

              <div class="table-wrap">
                <table class="table" id="tblItems">
                  <thead><tr><th>Item</th><th>Tipe</th><th>Stok</th><th></th></tr></thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- PURCHASING -->
        <div class="panel card" data-panel="purchasing">
          <div class="panel-head">
            <h2>üõí Purchasing</h2>
            <div class="muted">Buat PO & terima barang (stok masuk)</div>
          </div>

          <div class="two-col">
            <div class="card inner">
              <h3>üßæ Buat PO</h3>
              <form id="formPO" class="form">
                <div class="row">
                  <label>Vendor</label>
                  <select name="vendorId" id="poVendor" required></select>
                </div>
                <div class="row">
                  <label>Tanggal PO</label>
                  <input type="date" name="date" required />
                </div>

                <div class="row">
                  <label>Item</label>
                  <select name="itemId" id="poItem" required></select>
                </div>
                <div class="row two">
                  <div>
                    <label>Qty</label>
                    <input type="number" min="0" step="1" name="qty" required />
                  </div>
                  <div>
                    <label>Harga Beli</label>
                    <input type="number" min="0" step="100" name="price" required />
                  </div>
                </div>

                <button class="btn" type="submit">Tambah PO</button>
              </form>
            </div>

            <div class="card inner">
              <h3>üì• Daftar PO</h3>
              <div class="table-wrap">
                <table class="table" id="tblPO">
                  <thead>
                    <tr>
                      <th>Tanggal</th><th>Vendor</th><th>Item</th><th>Qty</th><th>Total</th><th>Status</th><th></th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div class="small muted">Klik <b>Receive</b> untuk menambah stok & mencatat expense.</div>
            </div>
          </div>
        </div>

        <!-- INVENTORY -->
        <div class="panel card" data-panel="inventory">
          <div class="panel-head">
            <h2>üè∑Ô∏è Inventory</h2>
            <div class="muted">Mutasi stok & penyesuaian</div>
          </div>

          <div class="two-col">
            <div class="card inner">
              <h3>‚ûï Stock Adjustment</h3>
              <form id="formAdjust" class="form">
                <div class="row">
                  <label>Item</label>
                  <select name="itemId" id="adjItem" required></select>
                </div>
                <div class="row two">
                  <div>
                    <label>Qty (+ / -)</label>
                    <input type="number" name="qty" step="1" required />
                  </div>
                  <div>
                    <label>Catatan</label>
                    <input name="note" placeholder="Koreksi stok / rusak / opname" />
                  </div>
                </div>
                <button class="btn" type="submit">Simpan Adjustment</button>
              </form>
            </div>

            <div class="card inner">
              <h3>üì¶ Stok Saat Ini</h3>
              <div class="table-wrap">
                <table class="table" id="tblStock">
                  <thead><tr><th>Item</th><th>Tipe</th><th>Stok</th><th>Avg Cost</th></tr></thead>
                  <tbody></tbody>
                </table>
              </div>
              <div class="small muted">Avg cost dihitung dari pembelian PO (template sederhana).</div>
            </div>
          </div>
        </div>

        <!-- PRODUCTION -->
        <div class="panel card" data-panel="production">
          <div class="panel-head">
            <h2>üßµ Production</h2>
            <div class="muted">Consume bahan ‚Üí output produk jadi</div>
          </div>

          <div class="two-col">
            <div class="card inner">
              <h3>üè≠ Work Order</h3>
              <form id="formWO" class="form">
                <div class="row">
                  <label>Tanggal</label>
                  <input type="date" name="date" required />
                </div>

                <div class="row">
                  <label>Bahan (Consume)</label>
                  <select name="consumeItemId" id="woConsumeItem" required></select>
                </div>
                <div class="row">
                  <label>Qty Consume</label>
                  <input type="number" name="consumeQty" min="0" step="1" required />
                </div>

                <div class="row">
                  <label>Produk Jadi (Output)</label>
                  <select name="outputItemId" id="woOutputItem" required></select>
                </div>
                <div class="row">
                  <label>Qty Output</label>
                  <input type="number" name="outputQty" min="0" step="1" required />
                </div>

                <button class="btn" type="submit">Tambah WO</button>
              </form>
            </div>

            <div class="card inner">
              <h3>üìã Daftar WO</h3>
              <div class="table-wrap">
                <table class="table" id="tblWO">
                  <thead>
                    <tr>
                      <th>Tanggal</th><th>Consume</th><th>Qty</th><th>Output</th><th>Qty</th><th>Status</th><th></th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div class="small muted">Klik <b>Complete</b> untuk mengurangi stok bahan & menambah stok produk jadi.</div>
            </div>
          </div>
        </div>

        <!-- SALES -->
        <div class="panel card" data-panel="sales">
          <div class="panel-head">
            <h2>üíº Sales</h2>
            <div class="muted">Sales Order & invoice sederhana</div>
          </div>

          <div class="two-col">
            <div class="card inner">
              <h3>üßæ Buat Sales Order</h3>
              <form id="formSO" class="form">
                <div class="row">
                  <label>Customer</label>
                  <select name="customerId" id="soCustomer" required></select>
                </div>
                <div class="row">
                  <label>Tanggal</label>
                  <input type="date" name="date" required />
                </div>
                <div class="row">
                  <label>Item</label>
                  <select name="itemId" id="soItem" required></select>
                </div>
                <div class="row two">
                  <div>
                    <label>Qty</label>
                    <input type="number" min="0" step="1" name="qty" required />
                  </div>
                  <div>
                    <label>Harga</label>
                    <input type="number" min="0" step="100" name="price" required />
                  </div>
                </div>
                <button class="btn" type="submit">Tambah SO</button>
              </form>
            </div>

            <div class="card inner">
              <h3>üì¶ Daftar SO</h3>
              <div class="table-wrap">
                <table class="table" id="tblSO">
                  <thead>
                    <tr>
                      <th>Tanggal</th><th>Customer</th><th>Item</th><th>Qty</th><th>Total</th><th>Status</th><th></th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div class="small muted">Klik <b>Invoice</b> untuk mencatat income. Klik <b>Ship</b> untuk proses pengiriman.</div>
            </div>
          </div>
        </div>

        <!-- SHIPPING -->
        <div class="panel card" data-panel="shipping">
          <div class="panel-head">
            <h2>üöö Shipping</h2>
            <div class="muted">Pengiriman & stok keluar</div>
          </div>

          <div class="card inner">
            <h3>üì¶ Daftar Pengiriman</h3>
            <div class="table-wrap">
              <table class="table" id="tblShip">
                <thead>
                  <tr>
                    <th>Tanggal</th><th>Customer</th><th>Item</th><th>Qty</th><th>Status</th><th></th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
            <div class="small muted">Klik <b>Deliver</b> untuk mengurangi stok (keluar).</div>
          </div>
        </div>

        <!-- RETURNS -->
        <div class="panel card" data-panel="returns">
          <div class="panel-head">
            <h2>üîÅ Returns</h2>
            <div class="muted">Retur customer / retur ke vendor</div>
          </div>

          <div class="two-col">
            <div class="card inner">
              <h3>‚Ü©Ô∏è Retur Customer (stok masuk)</h3>
              <form id="formReturnCustomer" class="form">
                <div class="row">
                  <label>Customer</label>
                  <select name="customerId" id="retCustCustomer" required></select>
                </div>
                <div class="row">
                  <label>Item</label>
                  <select name="itemId" id="retCustItem" required></select>
                </div>
                <div class="row two">
                  <div>
                    <label>Qty</label>
                    <input type="number" min="0" step="1" name="qty" required />
                  </div>
                  <div>
                    <label>Alasan</label>
                    <input name="reason" placeholder="Size salah / cacat / dll" />
                  </div>
                </div>
                <button class="btn" type="submit">Simpan Retur</button>
              </form>
            </div>

            <div class="card inner">
              <h3>‚Ü™Ô∏è Retur ke Vendor (stok keluar)</h3>
              <form id="formReturnVendor" class="form">
                <div class="row">
                  <label>Vendor</label>
                  <select name="vendorId" id="retVenVendor" required></select>
                </div>
                <div class="row">
                  <label>Item</label>
                  <select name="itemId" id="retVenItem" required></select>
                </div>
                <div class="row two">
                  <div>
                    <label>Qty</label>
                    <input type="number" min="0" step="1" name="qty" required />
                  </div>
                  <div>
                    <label>Alasan</label>
                    <input name="reason" placeholder="Kain rusak / salah kirim / dll" />
                  </div>
                </div>
                <button class="btn" type="submit">Simpan Retur</button>
              </form>
            </div>
          </div>

          <div class="card inner">
            <h3>üìú Riwayat Retur</h3>
            <div class="table-wrap">
              <table class="table" id="tblReturns">
                <thead>
                  <tr>
                    <th>Tanggal</th><th>Tipe</th><th>Partner</th><th>Item</th><th>Qty</th><th>Alasan</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- FINANCE -->
        <div class="panel card" data-panel="finance">
          <div class="panel-head">
            <h2>üí∞ Finance</h2>
            <div class="muted">Cashflow & input transaksi manual</div>
          </div>

          <div class="two-col">
            <div class="card inner">
              <h3>‚ûï Input Manual</h3>
              <form id="formFinance" class="form">
                <div class="row">
                  <label>Tanggal</label>
                  <input type="date" name="date" required />
                </div>
                <div class="row">
                  <label>Jenis</label>
                  <select name="type">
                    <option value="income">Income (Masuk)</option>
                    <option value="expense">Expense (Keluar)</option>
                  </select>
                </div>
                <div class="row">
                  <label>Kategori</label>
                  <input name="category" placeholder="Gaji / listrik / iklan / dll" required />
                </div>
                <div class="row">
                  <label>Nominal</label>
                  <input type="number" min="0" step="100" name="amount" required />
                </div>
                <div class="row">
                  <label>Catatan</label>
                  <input name="note" placeholder="optional" />
                </div>
                <button class="btn" type="submit">Simpan</button>
              </form>
            </div>

            <div class="card inner">
              <h3>üìí Cashflow</h3>
              <div class="table-wrap">
                <table class="table" id="tblFinance">
                  <thead>
                    <tr>
                      <th>Tanggal</th><th>Type</th><th>Kategori</th><th>Nominal</th><th>Catatan</th><th></th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div class="small muted">Transaksi dari PO (expense) & Invoice SO (income) akan masuk otomatis.</div>
            </div>
          </div>
        </div>

        <!-- REPORTS -->
        <div class="panel card" data-panel="reports">
          <div class="panel-head">
            <h2>üìë Reports</h2>
            <div class="muted">Laba Rugi sederhana + ringkasan</div>
          </div>

          <div class="two-col">
            <div class="card inner">
              <h3>üßæ Laba Rugi</h3>
              <div class="filters">
                <div>
                  <label>Dari</label>
                  <input type="date" id="repFrom">
                </div>
                <div>
                  <label>Sampai</label>
                  <input type="date" id="repTo">
                </div>
                <button class="btn" id="btnRunReport">Generate</button>
              </div>

              <div class="pnl-box" id="pnlBox">
                <div class="pnl-row">
                  <div>Income</div><div id="repIncome">Rp 0</div>
                </div>
                <div class="pnl-row">
                  <div>Expense</div><div id="repExpense">Rp 0</div>
                </div>
                <div class="pnl-row total">
                  <div>Profit</div><div id="repProfit">Rp 0</div>
                </div>
              </div>
              <div class="small muted">Ini versi master (cash basis). Kalau mau accrual + COGS detail, gue upgrade.</div>
            </div>

            <div class="card inner">
              <h3>üìå Summary</h3>
              <div class="list" id="summaryBox"></div>
            </div>
          </div>
        </div>

      </section>
    </section>
  </main>

  <footer class="footer">
    <div>‚ö° Master ERP Template ‚Ä¢ Offline First ‚Ä¢ PWA Ready</div>
    <div class="muted">Data tersimpan di browser (LocalStorage). Backup JSON biar aman.</div>
  </footer>

  <script src="app.js"></script>
</body>
</html>
