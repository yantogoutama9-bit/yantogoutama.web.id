<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master ERP Offline</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; color: #333; line-height: 1.6; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h1 { font-size: 2.5em; margin-bottom: 10px; }
        
        .nav-tabs { display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; }
        .nav-tab { background: white; padding: 12px 24px; border-radius: 25px; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.1); transition: all 0.3s; border: none; font-weight: 600; }
        .nav-tab:hover, .nav-tab.active { background: #667eea; color: white; transform: translateY(-2px); }
        
        .section { background: white; padding: 30px; border-radius: 15px; margin-bottom: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); display: none; }
        .section.active { display: block; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .stat-value { font-size: 2.5em; font-weight: bold; margin-bottom: 5px; }
        .stat-label { font-size: 0.9em; opacity: 0.9; }
        
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #555; }
        input, select, textarea { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #667eea; }
        
        button { background: #667eea; color: white; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600; transition: all 0.3s; }
        button:hover { background: #5568d3; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102,126,234,0.4); }
        button.danger { background: #e74c3c; }
        button.danger:hover { background: #c0392b; }
        button.success { background: #27ae60; }
        button.secondary { background: #95a5a6; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 14px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: #f8f9fa; font-weight: 600; color: #555; }
        tr:hover { background: #f8f9fa; }
        
        .badge { padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .badge.active { background: #d4edda; color: #155724; }
        .badge.inactive { background: #f8d7da; color: #721c24; }
        .badge.sales { background: #fff3cd; color: #856404; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 30px; border-radius: 15px; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto; }
        .close { float: right; font-size: 28px; cursor: pointer; color: #999; }
        .close:hover { color: #333; }
        
        .gender-chart { display: flex; height: 30px; border-radius: 15px; overflow: hidden; margin: 20px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .gender-male { background: #667eea; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px; }
        .gender-female { background: #f093fb; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px; }
        
        .filter-bar { display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; }
        .filter-bar input, .filter-bar select { width: auto; min-width: 200px; }
        
        .turnover-rate { font-size: 1.2em; font-weight: bold; color: #e74c3c; }
        
        .payroll-slip { background: white; border: 2px solid #333; padding: 40px; max-width: 800px; margin: 0 auto; font-family: 'Courier New', monospace; }
        .payroll-header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }
        .payroll-title { font-size: 24px; font-weight: bold; margin-bottom: 10px; }
        .payroll-company { font-size: 14px; margin-bottom: 5px; }
        .payroll-address { font-size: 12px; color: #666; font-style: italic; }
        .payroll-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 20px; }
        .payroll-section h3 { border-bottom: 1px solid #333; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; }
        .payroll-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; }
        .payroll-row.total { font-weight: bold; border-top: 1px solid #333; padding-top: 10px; margin-top: 10px; }
        .payroll-info { display: grid; grid-template-columns: 120px 1fr; gap: 10px; margin-bottom: 30px; font-size: 14px; }
        .payroll-info-label { font-weight: bold; }
        .payroll-signature { margin-top: 40px; display: grid; grid-template-columns: 1fr 1fr; gap: 50px; }
        .signature-box { text-align: center; }
        .signature-line { border-top: 1px solid #333; margin-top: 60px; padding-top: 5px; font-size: 12px; }
        
        .input-manual { background: #fff3cd; border: 1px solid #ffc107; }
        .input-auto { background: #d4edda; border: 1px solid #28a745; }
        
        .search-box { position: relative; }
        .search-results { position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #ddd; border-radius: 8px; max-height: 200px; overflow-y: auto; z-index: 100; display: none; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .search-result-item { padding: 10px; cursor: pointer; border-bottom: 1px solid #eee; }
        .search-result-item:hover { background: #f8f9fa; }
        
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
        
        @media print { .no-print { display: none; } body { background: white; } .payroll-slip { border: none; } }
        @media (max-width: 768px) { 
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            .nav-tabs { flex-direction: column; }
            .payroll-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üè¢ Master ERP (Offline)</h1>
            <p>Sistem Enterprise Resource Planning - Local Storage Version</p>
            <small style="opacity: 0.8;">üíæ Data tersimpan di browser (LocalStorage)</small>
        </header>

        <div class="nav-tabs no-print">
            <button class="nav-tab active" onclick="showSection('dashboard')">üìä Dashboard</button>
            <button class="nav-tab" onclick="showSection('master')">üß© Master Data</button>
            <button class="nav-tab" onclick="showSection('purchasing')">üõí Purchasing</button>
            <button class="nav-tab" onclick="showSection('inventory')">üì¶ Inventory</button>
            <button class="nav-tab" onclick="showSection('production')">üè≠ Production</button>
            <button class="nav-tab" onclick="showSection('sales')">üíº Sales</button>
            <button class="nav-tab" onclick="showSection('shipping')">üöö Shipping</button>
            <button class="nav-tab" onclick="showSection('returns')">üîÑ Returns</button>
            <button class="nav-tab" onclick="showSection('finance')">üí∞ Finance</button>
            <button class="nav-tab" onclick="showSection('hr')">üë• HR / Karyawan</button>
            <button class="nav-tab" onclick="showSection('payroll')">üíµ Slip Gaji</button>
        </div>

        <!-- DASHBOARD SECTION -->
        <div id="dashboard" class="section active">
            <h2>üìä Dashboard</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="dashStock">Rp 0</div>
                    <div class="stat-label">Nilai Stok</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-value" id="dashSales">Rp 0</div>
                    <div class="stat-label">Sales Bulan Ini</div>
                </div>
                <div class="stat-card info">
                    <div class="stat-value" id="dashProfit">Rp 0</div>
                    <div class="stat-label">Profit Bulan Ini</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-value" id="dashEmployees">0</div>
                    <div class="stat-label">Total Karyawan</div>
                </div>
            </div>
            
            <div style="background: white; padding: 20px; border-radius: 10px; margin-top: 20px;">
                <h3>üìù Ringkasan Aktivitas</h3>
                <div id="activitySummary" style="margin-top: 15px;">
                    <p>Loading...</p>
                </div>
            </div>
        </div>

        <!-- MASTER DATA SECTION -->
        <div id="master" class="section">
            <h2>üß© Master Data</h2>
            
            <div class="grid-3">
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h3>üè≠ Vendor</h3>
                    <button onclick="openMasterModal('vendor')" style="width: 100%; margin-bottom: 10px;">+ Tambah Vendor</button>
                    <div id="vendorList" style="max-height: 300px; overflow-y: auto;"></div>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h3>üë• Customer</h3>
                    <button onclick="openMasterModal('customer')" style="width: 100%; margin-bottom: 10px;">+ Tambah Customer</button>
                    <div id="customerList" style="max-height: 300px; overflow-y: auto;"></div>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h3>üì¶ Items</h3>
                    <button onclick="openMasterModal('item')" style="width: 100%; margin-bottom: 10px;">+ Tambah Item</button>
                    <div id="itemList" style="max-height: 300px; overflow-y: auto;"></div>
                </div>
            </div>
        </div>

        <!-- PURCHASING SECTION -->
        <div id="purchasing" class="section">
            <h2>üõí Purchasing</h2>
            <p>Buat Purchase Order & terima barang (stok masuk)</p>
            
            <div style="margin: 20px 0;">
                <button onclick="openPOModal()">‚ûï Buat PO Baru</button>
            </div>

            <h3>üìã Daftar Purchase Order</h3>
            <table id="poTable">
                <thead>
                    <tr>
                        <th>Tanggal</th>
                        <th>No PO</th>
                        <th>Vendor</th>
                        <th>Item</th>
                        <th>Qty</th>
                        <th>Total</th>
                        <th>Status</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="poTableBody"></tbody>
            </table>
        </div>

        <!-- INVENTORY SECTION -->
        <div id="inventory" class="section">
            <h2>üì¶ Inventory</h2>
            <p>Mutasi stok & penyesuaian</p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalItems">0</div>
                    <div class="stat-label">Total SKU</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-value" id="lowStock">0</div>
                    <div class="stat-label">Stok Menipis</div>
                </div>
            </div>

            <div style="margin: 20px 0;">
                <button onclick="openStockAdjustmentModal()">‚öñÔ∏è Stock Adjustment</button>
            </div>

            <h3>üì¶ Stok Saat Ini</h3>
            <table id="inventoryTable">
                <thead>
                    <tr>
                        <th>Kode</th>
                        <th>Nama Item</th>
                        <th>Kategori</th>
                        <th>Stok</th>
                        <th>Avg Cost</th>
                        <th>Nilai Stok</th>
                    </tr>
                </thead>
                <tbody id="inventoryTableBody"></tbody>
            </table>
        </div>

        <!-- PRODUCTION SECTION -->
        <div id="production" class="section">
            <h2>üè≠ Production</h2>
            <p>Consume bahan ‚Üí output produk jadi</p>
            
            <div style="margin: 20px 0;">
                <button onclick="openWOModal()">‚ûï Buat Work Order</button>
            </div>

            <h3>üìã Daftar Work Order</h3>
            <table id="woTable">
                <thead>
                    <tr>
                        <th>Tanggal</th>
                        <th>No WO</th>
                        <th>Consume</th>
                        <th>Qty</th>
                        <th>Output</th>
                        <th>Qty</th>
                        <th>Status</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="woTableBody"></tbody>
            </table>
        </div>

        <!-- SALES SECTION -->
        <div id="sales" class="section">
            <h2>üíº Sales</h2>
            <p>Sales Order & invoice sederhana</p>
            
            <div style="margin: 20px 0;">
                <button onclick="openSOModal()">‚ûï Buat Sales Order</button>
            </div>

            <h3>üìã Daftar Sales Order</h3>
            <table id="soTable">
                <thead>
                    <tr>
                        <th>Tanggal</th>
                        <th>No SO</th>
                        <th>Customer</th>
                        <th>Item</th>
                        <th>Qty</th>
                        <th>Total</th>
                        <th>Status</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="soTableBody"></tbody>
            </table>
        </div>

        <!-- SHIPPING SECTION -->
        <div id="shipping" class="section">
            <h2>üöö Shipping</h2>
            <p>Pengiriman & stok keluar</p>

            <h3>üì¶ Daftar Pengiriman</h3>
            <table id="shippingTable">
                <thead>
                    <tr>
                        <th>Tanggal</th>
                        <th>No Ref</th>
                        <th>Customer</th>
                        <th>Item</th>
                        <th>Qty</th>
                        <th>Status</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="shippingTableBody"></tbody>
            </table>
        </div>

        <!-- RETURNS SECTION -->
        <div id="returns" class="section">
            <h2>üîÑ Returns</h2>
            <p>Retur customer / retur ke vendor</p>
            
            <div style="margin: 20px 0;">
                <button onclick="openReturnModal('customer')">‚Ü©Ô∏è Retur Customer</button>
                <button onclick="openReturnModal('vendor')" style="margin-left: 10px;">‚Ü™Ô∏è Retur ke Vendor</button>
            </div>

            <h3>üìú Riwayat Retur</h3>
            <table id="returnsTable">
                <thead>
                    <tr>
                        <th>Tanggal</th>
                        <th>Tipe</th>
                        <th>Partner</th>
                        <th>Item</th>
                        <th>Qty</th>
                        <th>Alasan</th>
                    </tr>
                </thead>
                <tbody id="returnsTableBody"></tbody>
            </table>
        </div>

        <!-- FINANCE SECTION -->
        <div id="finance" class="section">
            <h2>üí∞ Finance</h2>
            <p>Cashflow & input transaksi manual</p>
            
            <div style="margin: 20px 0;">
                <button onclick="openFinanceModal()">‚ûï Input Transaksi Manual</button>
            </div>

            <h3>üìí Cashflow</h3>
            <table id="financeTable">
                <thead>
                    <tr>
                        <th>Tanggal</th>
                        <th>Type</th>
                        <th>Kategori</th>
                        <th>Nominal</th>
                        <th>Catatan</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="financeTableBody"></tbody>
            </table>

            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 30px;">
                <h3>üìä Laba Rugi Sederhana</h3>
                <div id="profitLossReport"></div>
            </div>
        </div>

        <!-- HR SECTION -->
        <div id="hr" class="section">
            <h2>üë• Manajemen Karyawan</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalEmployees">0</div>
                    <div class="stat-label">Total Karyawan</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-value" id="activeEmployees">0</div>
                    <div class="stat-label">Karyawan Aktif</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-value" id="inactiveEmployees">0</div>
                    <div class="stat-label">Karyawan Non-Aktif</div>
                </div>
                <div class="stat-card info">
                    <div class="stat-value" id="totalSales">0</div>
                    <div class="stat-label">Tim Sales</div>
                </div>
            </div>

            <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                <h3>üë´ Komposisi Gender</h3>
                <div class="gender-chart">
                    <div class="gender-male" id="maleBar" style="width: 0%">0%</div>
                    <div class="gender-female" id="femaleBar" style="width: 0%">0%</div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                    <span>üë® Pria: <strong id="maleCount">0</strong></span>
                    <span>üë© Wanita: <strong id="femaleCount">0</strong></span>
                </div>
            </div>

            <div style="background: #fee; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #e74c3c;">
                <h3>üìâ Turnover Rate</h3>
                <div class="turnover-rate" id="turnoverRate">0%</div>
                <small>Perhitungan: (Karyawan Keluar / Total Karyawan) √ó 100</small>
            </div>

            <div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
                <h3>üéØ Kontribusi Tim Sales</h3>
                <p>Total Sales Order oleh Tim Sales: <strong id="salesContribution">Rp 0</strong></p>
                <p>Persentase dari Total Penjualan: <strong id="salesPercentage">0%</strong></p>
            </div>

            <div style="margin: 20px 0;">
                <button onclick="openEmployeeModal()">‚ûï Tambah Karyawan</button>
                <button onclick="exportEmployeesToExcel()" class="success" style="margin-left: 10px;">üìä Export Excel</button>
            </div>

            <div class="filter-bar">
                <input type="text" id="searchEmployee" placeholder="üîç Cari nama/NIP..." onkeyup="filterEmployees()">
                <select id="filterStatus" onchange="filterEmployees()">
                    <option value="">Semua Status</option>
                    <option value="active">Aktif</option>
                    <option value="inactive">Non-Aktif</option>
                </select>
                <select id="filterUnit" onchange="filterEmployees()">
                    <option value="">Semua Unit</option>
                    <option value="sales">Sales</option>
                    <option value="production">Production</option>
                    <option value="finance">Finance</option>
                    <option value="warehouse">Warehouse</option>
                    <option value="hr">HR</option>
                </select>
            </div>

            <table id="employeeTable">
                <thead>
                    <tr>
                        <th>NIP</th>
                        <th>Nama</th>
                        <th>Jenis Kelamin</th>
                        <th>Jabatan</th>
                        <th>Unit</th>
                        <th>Tgl Masuk</th>
                        <th>Gaji Pokok</th>
                        <th>Status</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="employeeTableBody"></tbody>
            </table>
        </div>

        <!-- PAYROLL SECTION -->
        <div id="payroll" class="section">
            <h2>üíµ Slip Gaji Karyawan</h2>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 30px;">
                <h3>üîç Cari Karyawan</h3>
                <div class="search-box">
                    <input type="text" id="searchPayrollEmployee" placeholder="Ketik nama atau NIP karyawan..." 
                           onkeyup="searchEmployeeForPayroll()" autocomplete="off">
                    <div id="payrollSearchResults" class="search-results"></div>
                </div>
                <small style="color: #666;">* Data gaji pokok akan terisi otomatis saat memilih karyawan</small>
            </div>

            <div id="payrollForm" style="display: none;">
                <div class="grid-2" style="margin-bottom: 20px;">
                    <div class="form-group">
                        <label>Periode (Bulan/Tahun)</label>
                        <input type="text" id="payrollPeriod" placeholder="Februari 2026" class="input-manual">
                    </div>
                    <div class="form-group">
                        <label>Alamat Unit</label>
                        <input type="text" id="payrollAddress" placeholder="Jl. Kenari F-12..." class="input-manual">
                    </div>
                </div>

                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <h4>üìã Data Karyawan (Auto-fill)</h4>
                    <div class="grid-2" style="margin-top: 10px;">
                        <div><strong>Nama:</strong> <span id="payrollName">-</span></div>
                        <div><strong>NIP:</strong> <span id="payrollNIP">-</span></div>
                        <div><strong>Unit:</strong> <span id="payrollUnit">-</span></div>
                        <div><strong>Jabatan:</strong> <span id="payrollPosition">-</span></div>
                    </div>
                    <div style="margin-top: 10px;">
                        <strong>Gaji Pokok:</strong> <span id="payrollBasicSalary">Rp 0</span>
                    </div>
                </div>

                <h3>üí∞ Komponen Gaji (Input Manual)</h3>
                <div class="grid-2">
                    <div style="background: #d4edda; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #155724; margin-bottom: 15px;">‚ûï PENERIMAAN</h4>
                        <div class="form-group">
                            <label>Gaji Pokok (Auto)</label>
                            <input type="text" id="pokok" readonly class="input-auto">
                        </div>
                        <div class="form-group">
                            <label>Tunjangan Jabatan</label>
                            <input type="number" id="tunjanganJabatan" value="0" class="input-manual" onchange="calculatePayroll()">
                        </div>
                        <div class="form-group">
                            <label>Perjalanan Dinas</label>
                            <input type="number" id="perjalananDinas" value="0" class="input-manual" onchange="calculatePayroll()">
                        </div>
                        <div class="form-group">
                            <label>Lembur</label>
                            <input type="number" id="lembur" value="0" class="input-manual" onchange="calculatePayroll()">
                        </div>
                        <div class="form-group" style="border-top: 2px solid #28a745; padding-top: 10px; margin-top: 15px;">
                            <label style="color: #155724; font-weight: bold;">Gaji Kotor</label>
                            <input type="text" id="gajiKotor" readonly style="font-weight: bold; color: #155724;">
                        </div>
                    </div>

                    <div style="background: #f8d7da; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #721c24; margin-bottom: 15px;">‚ûñ POTONGAN</h4>
                        <div class="form-group">
                            <label>Tidak Masuk Kerja</label>
                            <input type="number" id="potonganAbsen" value="0" class="input-manual" onchange="calculatePayroll()">
                        </div>
                        <div class="form-group">
                            <label>Terlambat</label>
                            <input type="number" id="potonganTerlambat" value="0" class="input-manual" onchange="calculatePayroll()">
                        </div>
                        <div class="form-group">
                            <label>Pulang Cepat / Izin 1/2 Hari</label>
                            <input type="number" id="potonganPulangCepat" value="0" class="input-manual" onchange="calculatePayroll()">
                        </div>
                        <div class="form-group">
                            <label>Potongan Bon</label>
                            <input type="number" id="potonganBon" value="0" class="input-manual" onchange="calculatePayroll()">
                        </div>
                        <div class="form-group">
                            <label>Potongan Seragam</label>
                            <input type="number" id="potonganSeragam" value="0" class="input-manual" onchange="calculatePayroll()">
                        </div>
                        <div class="form-group">
                            <label>Potongan BPJS</label>
                            <input type="number" id="potonganBPJS" value="0" class="input-manual" onchange="calculatePayroll()">
                        </div>
                        <div class="form-group" style="border-top: 2px solid #dc3545; padding-top: 10px; margin-top: 15px;">
                            <label style="color: #721c24; font-weight: bold;">Total Potongan</label>
                            <input type="text" id="totalPotongan" readonly style="font-weight: bold; color: #721c24;">
                        </div>
                    </div>
                </div>

                <div style="background: #d1ecf1; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: center; border: 2px solid #17a2b8;">
                    <h3 style="color: #0c5460; margin-bottom: 10px;">TOTAL GAJI YANG DITERIMA</h3>
                    <div style="font-size: 32px; font-weight: bold; color: #0c5460;" id="totalGaji">Rp 0</div>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="generateSlipPreview()">üëÅÔ∏è Preview Slip</button>
                    <button onclick="exportPayrollToExcel()" class="success">üìä Export Excel</button>
                    <button onclick="printSlip()" class="secondary">üñ®Ô∏è Print</button>
                    <button onclick="resetPayroll()" class="danger">üîÑ Reset</button>
                </div>
            </div>

            <!-- Preview Slip Gaji -->
            <div id="slipPreview" style="display: none; margin-top: 30px;">
                <div class="payroll-slip" id="slipContent">
                    <div class="payroll-header">
                        <div class="payroll-title">SLIP GAJI BULANAN</div>
                        <div class="payroll-company">UNIT : <span id="slipUnitText"></span></div>
                        <div class="payroll-address" id="slipAddress"></div>
                    </div>

                    <div class="payroll-info">
                        <div class="payroll-info-label">Periode</div>
                        <div id="slipPeriod"></div>
                        <div class="payroll-info-label">Nama</div>
                        <div id="slipName"></div>
                        <div class="payroll-info-label">Jabatan</div>
                        <div id="slipPosition"></div>
                        <div class="payroll-info-label">NIP</div>
                        <div id="slipNIP"></div>
                    </div>

                    <div class="payroll-grid">
                        <div class="payroll-section">
                            <h3>PENERIMAAN</h3>
                            <div class="payroll-row"><span>Gaji Pokok</span><span id="slipPokok"></span></div>
                            <div class="payroll-row"><span>Tunjangan Jabatan</span><span id="slipTunjanganJabatan"></span></div>
                            <div class="payroll-row"><span>Perjalanan Dinas</span><span id="slipPerjalananDinas"></span></div>
                            <div class="payroll-row"><span>Lembur</span><span id="slipLembur"></span></div>
                            <div class="payroll-row total"><span>Gaji Kotor</span><span id="slipGajiKotor"></span></div>
                        </div>

                        <div class="payroll-section">
                            <h3>POTONGAN</h3>
                            <div class="payroll-row"><span>Tidak Masuk Kerja</span><span id="slipPotonganAbsen"></span></div>
                            <div class="payroll-row"><span>Terlambat</span><span id="slipPotonganTerlambat"></span></div>
                            <div class="payroll-row"><span>Pulang Cepat / Izin 1/2 Hari</span><span id="slipPotonganPulangCepat"></span></div>
                            <div class="payroll-row"><span>Potongan Bon</span><span id="slipPotonganBon"></span></div>
                            <div class="payroll-row"><span>Potongan Seragam</span><span id="slipPotonganSeragam"></span></div>
                            <div class="payroll-row"><span>Potongan BPJS</span><span id="slipPotonganBPJS"></span></div>
                            <div class="payroll-row total"><span>Total Potongan</span><span id="slipTotalPotongan"></span></div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 30px; padding: 20px; border: 2px solid #333; font-weight: bold; font-size: 18px;">
                        TOTAL GAJI YANG DITERIMA: <span id="slipTotalGaji"></span>
                    </div>

                    <div class="payroll-signature">
                        <div class="signature-box"><div class="signature-line">Dibuat Oleh<br>HRD</div></div>
                        <div class="signature-box"><div class="signature-line">Diterima Oleh<br>Karyawan</div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Employee Modal -->
    <div id="employeeModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEmployeeModal()">&times;</span>
            <h2 id="modalTitle">Tambah Karyawan Baru</h2>
            <form id="employeeForm" onsubmit="saveEmployee(event)">
                <input type="hidden" id="editIndex">
                
                <div class="grid-2">
                    <div class="form-group">
                        <label>Nomor Induk Pegawai (NIP) *</label>
                        <input type="text" id="nip" required placeholder="EMP001">
                    </div>
                    <div class="form-group">
                        <label>Nama Lengkap *</label>
                        <input type="text" id="nama" required>
                    </div>
                    <div class="form-group">
                        <label>Jenis Kelamin *</label>
                        <select id="gender" required>
                            <option value="">Pilih</option>
                            <option value="Laki-laki">Laki-laki</option>
                            <option value="Perempuan">Perempuan</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tanggal Lahir *</label>
                        <input type="date" id="tglLahir" required>
                    </div>
                    <div class="form-group">
                        <label>Nomor WhatsApp *</label>
                        <input type="tel" id="noWA" required placeholder="08xxxxxxxxxx">
                    </div>
                    <div class="form-group">
                        <label>Alamat Email *</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label>Tanggal Masuk *</label>
                        <input type="date" id="tglMasuk" required>
                    </div>
                    <div class="form-group">
                        <label>Unit/Bagian *</label>
                        <select id="unit" required onchange="checkSalesUnit()">
                            <option value="">Pilih Unit</option>
                            <option value="sales">Sales/Marketing</option>
                            <option value="production">Production</option>
                            <option value="finance">Finance</option>
                            <option value="warehouse">Warehouse</option>
                            <option value="hr">HR</option>
                            <option value="it">IT</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Jabatan *</label>
                        <input type="text" id="jabatan" required>
                    </div>
                    <div class="form-group">
                        <label>Gaji Pokok (Rp) *</label>
                        <input type="number" id="gaji" required>
                    </div>
                </div>

                <div class="form-group" style="margin-top: 20px;">
                    <label><input type="checkbox" id="isActive" checked onchange="toggleTanggalKeluar()"> Karyawan Aktif</label>
                </div>

                <div class="form-group" id="tanggalKeluarGroup" style="display: none;">
                    <label>Tanggal Keluar</label>
                    <input type="date" id="tglKeluar">
                </div>

                <div style="margin-top: 30px;">
                    <button type="submit">üíæ Simpan Karyawan</button>
                    <button type="button" onclick="closeEmployeeModal()" style="background: #95a5a6; margin-left: 10px;">Batal</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ==========================================
        // DATA STORAGE (LocalStorage)
        // ==========================================
        const Storage = {
            get: (key) => JSON.parse(localStorage.getItem('erp_' + key) || '[]'),
            set: (key, data) => localStorage.setItem('erp_' + key, JSON.stringify(data)),
            add: (key, item) => {
                const data = Storage.get(key);
                data.push(item);
                Storage.set(key, data);
                return data;
            },
            update: (key, id, newData, idField = 'id') => {
                const data = Storage.get(key);
                const index = data.findIndex(item => item[idField] === id);
                if(index !== -1) {
                    data[index] = { ...data[index], ...newData };
                    Storage.set(key, data);
                }
                return data;
            },
            delete: (key, id, idField = 'id') => {
                const data = Storage.get(key).filter(item => item[idField] !== id);
                Storage.set(key, data);
                return data;
            }
        };

        // ==========================================
        // INITIALIZATION
        // ==========================================
        document.addEventListener('DOMContentLoaded', function() {
            initData();
            renderAll();
        });

        function initData() {
            // Initialize default data if empty
            if(Storage.get('vendors').length === 0) {
                Storage.set('vendors', [
                    { id: 'V001', nama: 'PT Supplier Utama', alamat: 'Jl. Sudirman No. 1', telepon: '021-1234567' },
                    { id: 'V002', nama: 'CV Maju Jaya', alamat: 'Jl. Thamrin No. 2', telepon: '021-7654321' }
                ]);
            }
            if(Storage.get('customers').length === 0) {
                Storage.set('customers', [
                    { id: 'C001', nama: 'PT Customer ABC', alamat: 'Jl. Gatot Subroto No. 5', telepon: '021-5555555' },
                    { id: 'C002', nama: 'Toko Maju', alamat: 'Jl. Diponegoro No. 10', telepon: '021-6666666' }
                ]);
            }
            if(Storage.get('items').length === 0) {
                Storage.set('items', [
                    { id: 'I001', nama: 'Bahan Baku A', kategori: 'Raw Material', harga_beli: 50000, harga_jual: 75000, stok: 100 },
                    { id: 'I002', nama: 'Produk Jadi X', kategori: 'Finished Good', harga_beli: 100000, harga_jual: 150000, stok: 50 },
                    { id: 'I003', nama: 'Bahan Baku B', kategori: 'Raw Material', harga_beli: 30000, harga_jual: 45000, stok: 200 }
                ]);
            }
        }

        function renderAll() {
            renderDashboard();
            renderMasterData();
            renderPurchasing();
            renderInventory();
            renderProduction();
            renderSales();
            renderShipping();
            renderReturns();
            renderFinance();
            renderEmployees();
            updateHRStats();
        }

        // ==========================================
        // NAVIGATION
        // ==========================================
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
            
            if(sectionId === 'dashboard') renderDashboard();
            if(sectionId === 'hr') { renderEmployees(); updateHRStats(); }
        }

        // ==========================================
        // DASHBOARD
        // ==========================================
        function renderDashboard() {
            const items = Storage.get('items');
            const pos = Storage.get('purchase_orders');
            const sos = Storage.get('sales_orders');
            const employees = Storage.get('employees');
            
            // Calculate stock value
            const stockValue = items.reduce((sum, item) => sum + (item.stok * item.harga_beli), 0);
            document.getElementById('dashStock').textContent = 'Rp ' + stockValue.toLocaleString();
            
            // Calculate monthly sales
            const currentMonth = new Date().getMonth();
            const monthlySales = sos
                .filter(so => new Date(so.tanggal).getMonth() === currentMonth && so.status === 'invoiced')
                .reduce((sum, so) => sum + so.total, 0);
            document.getElementById('dashSales').textContent = 'Rp ' + monthlySales.toLocaleString();
            
            // Calculate profit (simplified)
            const expenses = pos.filter(po => po.status === 'received').reduce((sum, po) => sum + po.total, 0);
            const income = sos.filter(so => so.status === 'invoiced').reduce((sum, so) => sum + so.total, 0);
            const profit = income - expenses;
            document.getElementById('dashProfit').textContent = 'Rp ' + profit.toLocaleString();
            
            document.getElementById('dashEmployees').textContent = employees.length;
            
            // Activity summary
            const activity = [];
            if(sos.length > 0) activity.push(`üì¶ ${sos.length} Sales Order terdaftar`);
            if(pos.length > 0) activity.push(`üõí ${pos.length} Purchase Order aktif`);
            if(employees.length > 0) activity.push(`üë• ${employees.length} karyawan dalam database`);
            
            document.getElementById('activitySummary').innerHTML = activity.length > 0 
                ? activity.map(a => `<div style="padding: 5px 0;">${a}</div>`).join('') 
                : '<p>Belum ada aktivitas</p>';
        }

        // ==========================================
        // MASTER DATA
        // ==========================================
        function renderMasterData() {
            const vendors = Storage.get('vendors');
            const customers = Storage.get('customers');
            const items = Storage.get('items');
            
            document.getElementById('vendorList').innerHTML = vendors.map(v => `
                <div style="padding: 10px; border-bottom: 1px solid #eee;">
                    <strong>${v.nama}</strong><br>
                    <small>${v.id} | ${v.telepon}</small>
                </div>
            `).join('') || '<p style="color: #666;">Tidak ada data</p>';
            
            document.getElementById('customerList').innerHTML = customers.map(c => `
                <div style="padding: 10px; border-bottom: 1px solid #eee;">
                    <strong>${c.nama}</strong><br>
                    <small>${c.id} | ${c.telepon}</small>
                </div>
            `).join('') || '<p style="color: #666;">Tidak ada data</p>';
            
            document.getElementById('itemList').innerHTML = items.map(i => `
                <div style="padding: 10px; border-bottom: 1px solid #eee;">
                    <strong>${i.nama}</strong><br>
                    <small>${i.id} | Stok: ${i.stok} | Rp ${i.harga_jual.toLocaleString()}</small>
                </div>
            `).join('') || '<p style="color: #666;">Tidak ada data</p>';
        }

        function openMasterModal(type) {
            const nama = prompt(`Nama ${type}:`);
            if(!nama) return;
            
            const id = type === 'vendor' ? 'V' : type === 'customer' ? 'C' : 'I';
            const count = Storage.get(type + 's').length + 1;
            const newItem = {
                id: id + String(count).padStart(3, '0'),
                nama: nama,
                alamat: prompt('Alamat:') || '',
                telepon: prompt('Telepon:') || ''
            };
            
            if(type === 'item') {
                newItem.kategori = prompt('Kategori:') || 'Umum';
                newItem.harga_beli = parseFloat(prompt('Harga Beli:')) || 0;
                newItem.harga_jual = parseFloat(prompt('Harga Jual:')) || 0;
                newItem.stok = 0;
            }
            
            Storage.add(type + 's', newItem);
            renderMasterData();
            alert(`${type} berhasil ditambahkan!`);
        }

        // ==========================================
        // PURCHASING
        // ==========================================
        function renderPurchasing() {
            const pos = Storage.get('purchase_orders');
            const tbody = document.getElementById('poTableBody');
            
            tbody.innerHTML = pos.map(po => `
                <tr>
                    <td>${formatDate(po.tanggal)}</td>
                    <td>${po.no_po}</td>
                    <td>${po.vendor}</td>
                    <td>${po.item}</td>
                    <td>${po.qty}</td>
                    <td>Rp ${po.total.toLocaleString()}</td>
                    <td><span class="badge ${po.status}">${po.status}</span></td>
                    <td>
                        ${po.status === 'pending' ? `<button onclick="receivePO('${po.id}')" style="padding: 5px 10px; font-size: 12px;">üì• Receive</button>` : '-'}
                    </td>
                </tr>
            `).join('') || '<tr><td colspan="8" style="text-align: center;">Tidak ada PO</td></tr>';
        }

        function openPOModal() {
            const vendors = Storage.get('vendors');
            const items = Storage.get('items');
            
            const vendorNama = prompt('Vendor:\n' + vendors.map(v => v.nama).join('\n'));
            if(!vendorNama) return;
            
            const itemNama = prompt('Item:\n' + items.map(i => i.nama).join('\n'));
            if(!itemNama) return;
            
            const qty = parseInt(prompt('Quantity:')) || 0;
            const harga = parseFloat(prompt('Harga per unit:')) || 0;
            
            const po = {
                id: Date.now().toString(),
                no_po: 'PO-' + Date.now(),
                tanggal: new Date().toISOString(),
                vendor: vendorNama,
                item: itemNama,
                qty: qty,
                total: qty * harga,
                status: 'pending'
            };
            
            Storage.add('purchase_orders', po);
            renderPurchasing();
            
            // Add to finance
            Storage.add('finance', {
                id: Date.now().toString(),
                tanggal: new Date().toISOString(),
                type: 'expense',
                kategori: 'Purchasing',
                nominal: po.total,
                catatan: `PO ${po.no_po} - ${po.vendor}`
            });
        }

        function receivePO(id) {
            const po = Storage.get('purchase_orders').find(p => p.id === id);
            if(!po) return;
            
            // Update stock
            const items = Storage.get('items');
            const item = items.find(i => i.nama === po.item);
            if(item) {
                item.stok += po.qty;
                Storage.set('items', items);
            }
            
            // Update PO status
            Storage.update('purchase_orders', id, { status: 'received' });
            renderPurchasing();
            alert('Barang diterima dan stok diperbarui!');
        }

        // ==========================================
        // INVENTORY
        // ==========================================
        function renderInventory() {
            const items = Storage.get('items');
            const tbody = document.getElementById('inventoryTableBody');
            
            document.getElementById('totalItems').textContent = items.length;
            document.getElementById('lowStock').textContent = items.filter(i => i.stok < 10).length;
            
            tbody.innerHTML = items.map(item => {
                const nilai = item.stok * item.harga_beli;
                return `
                    <tr>
                        <td>${item.id}</td>
                        <td>${item.nama}</td>
                        <td>${item.kategori}</td>
                        <td>${item.stok}</td>
                        <td>Rp ${item.harga_beli.toLocaleString()}</td>
                        <td>Rp ${nilai.toLocaleString()}</td>
                    </tr>
                `;
            }).join('') || '<tr><td colspan="6" style="text-align: center;">Tidak ada data</td></tr>';
        }

        function openStockAdjustmentModal() {
            const items = Storage.get('items');
            const itemNama = prompt('Pilih item:\n' + items.map(i => i.nama).join('\n'));
            if(!itemNama) return;
            
            const item = items.find(i => i.nama === itemNama);
            const adjustment = parseInt(prompt(`Stok saat ini: ${item.stok}\nPenyesuaian (+/-):`)) || 0;
            
            item.stok += adjustment;
            Storage.set('items', items);
            renderInventory();
            alert('Stok diperbarui!');
        }

        // ==========================================
        // PRODUCTION
        // ==========================================
        function renderProduction() {
            const wos = Storage.get('work_orders');
            const tbody = document.getElementById('woTableBody');
            
            tbody.innerHTML = wos.map(wo => `
                <tr>
                    <td>${formatDate(wo.tanggal)}</td>
                    <td>${wo.no_wo}</td>
                    <td>${wo.consume}</td>
                    <td>${wo.qty_consume}</td>
                    <td>${wo.output}</td>
                    <td>${wo.qty_output}</td>
                    <td><span class="badge ${wo.status}">${wo.status}</span></td>
                    <td>
                        ${wo.status === 'pending' ? `<button onclick="completeWO('${wo.id}')" style="padding: 5px 10px; font-size: 12px;">‚úÖ Complete</button>` : '-'}
                    </td>
                </tr>
            `).join('') || '<tr><td colspan="8" style="text-align: center;">Tidak ada WO</td></tr>';
        }

        function openWOModal() {
            const items = Storage.get('items');
            const rawMaterials = items.filter(i => i.kategori === 'Raw Material');
            const finishedGoods = items.filter(i => i.kategori === 'Finished Good');
            
            const consume = prompt('Bahan yang dikonsumsi:\n' + rawMaterials.map(i => i.nama).join('\n'));
            if(!consume) return;
            
            const qtyConsume = parseInt(prompt('Qty konsumsi:')) || 0;
            
            const output = prompt('Produk jadi:\n' + finishedGoods.map(i => i.nama).join('\n'));
            if(!output) return;
            
            const qtyOutput = parseInt(prompt('Qty output:')) || 0;
            
            const wo = {
                id: Date.now().toString(),
                no_wo: 'WO-' + Date.now(),
                tanggal: new Date().toISOString(),
                consume: consume,
                qty_consume: qtyConsume,
                output: output,
                qty_output: qtyOutput,
                status: 'pending'
            };
            
            Storage.add('work_orders', wo);
            renderProduction();
        }

        function completeWO(id) {
            const wo = Storage.get('work_orders').find(w => w.id === id);
            if(!wo) return;
            
            const items = Storage.get('items');
            
            // Reduce raw material
            const raw = items.find(i => i.nama === wo.consume);
            if(raw) raw.stok -= wo.qty_consume;
            
            // Add finished good
            const finished = items.find(i => i.nama === wo.output);
            if(finished) finished.stok += wo.qty_output;
            
            Storage.set('items', items);
            Storage.update('work_orders', id, { status: 'completed' });
            renderProduction();
            alert('Work Order selesai! Stok diperbarui.');
        }

        // ==========================================
        // SALES
        // ==========================================
        function renderSales() {
            const sos = Storage.get('sales_orders');
            const tbody = document.getElementById('soTableBody');
            
            tbody.innerHTML = sos.map(so => `
                <tr>
                    <td>${formatDate(so.tanggal)}</td>
                    <td>${so.no_so}</td>
                    <td>${so.customer}</td>
                    <td>${so.item}</td>
                    <td>${so.qty}</td>
                    <td>Rp ${so.total.toLocaleString()}</td>
                    <td><span class="badge ${so.status}">${so.status}</span></td>
                    <td>
                        ${so.status === 'pending' ? `
                            <button onclick="invoiceSO('${so.id}')" style="padding: 5px 10px; font-size: 12px;">üßæ Invoice</button>
                            <button onclick="shipSO('${so.id}')" style="padding: 5px 10px; font-size: 12px; margin-left: 5px;">üöö Ship</button>
                        ` : '-'}
                    </td>
                </tr>
            `).join('') || '<tr><td colspan="8" style="text-align: center;">Tidak ada SO</td></tr>';
        }

        function openSOModal() {
            const customers = Storage.get('customers');
            const items = Storage.get('items');
            
            const customerNama = prompt('Customer:\n' + customers.map(c => c.nama).join('\n'));
            if(!customerNama) return;
            
            const itemNama = prompt('Item:\n' + items.map(i => i.nama).join('\n'));
            if(!itemNama) return;
            
            const qty = parseInt(prompt('Quantity:')) || 0;
            const item = items.find(i => i.nama === itemNama);
            
            const so = {
                id: Date.now().toString(),
                no_so: 'SO-' + Date.now(),
                tanggal: new Date().toISOString(),
                customer: customerNama,
                item: itemNama,
                qty: qty,
                total: qty * (item ? item.harga_jual : 0),
                status: 'pending'
            };
            
            Storage.add('sales_orders', so);
            renderSales();
            
            // Add to shipping queue
            Storage.add('shipping', {
                id: Date.now().toString(),
                tanggal: so.tanggal,
                no_ref: so.no_so,
                customer: customerNama,
                item: itemNama,
                qty: qty,
                status: 'pending'
            });
        }

        function invoiceSO(id) {
            const so = Storage.get('sales_orders').find(s => s.id === id);
            if(!so) return;
            
            Storage.update('sales_orders', id, { status: 'invoiced' });
            
            // Add to finance
            Storage.add('finance', {
                id: Date.now().toString(),
                tanggal: new Date().toISOString(),
                type: 'income',
                kategori: 'Sales',
                nominal: so.total,
                catatan: `Invoice ${so.no_so} - ${so.customer}`
            });
            
            renderSales();
            alert('Invoice dibuat dan income tercatat!');
        }

        function shipSO(id) {
            const so = Storage.get('sales_orders').find(s => s.id === id);
            if(!so) return;
            
            // Reduce stock
            const items = Storage.get('items');
            const item = items.find(i => i.nama === so.item);
            if(item) {
                item.stok -= so.qty;
                Storage.set('items', items);
            }
            
            Storage.update('sales_orders', id, { status: 'shipped' });
            Storage.update('shipping', so.no_so, { status: 'shipped' }, 'no_ref');
            renderSales();
            renderShipping();
            alert('Barang dikirim dan stok dikurangi!');
        }

        // ==========================================
        // SHIPPING
        // ==========================================
        function renderShipping() {
            const shipping = Storage.get('shipping');
            const tbody = document.getElementById('shippingTableBody');
            
            tbody.innerHTML = shipping.map(s => `
                <tr>
                    <td>${formatDate(s.tanggal)}</td>
                    <td>${s.no_ref}</td>
                    <td>${s.customer}</td>
                    <td>${s.item}</td>
                    <td>${s.qty}</td>
                    <td><span class="badge ${s.status}">${s.status}</span></td>
                    <td>
                        ${s.status === 'pending' ? `<button onclick="deliverItem('${s.id}')" style="padding: 5px 10px; font-size: 12px;">üì¶ Deliver</button>` : '‚úÖ Delivered'}
                    </td>
                </tr>
            `).join('') || '<tr><td colspan="7" style="text-align: center;">Tidak ada pengiriman</td></tr>';
        }

        function deliverItem(id) {
            Storage.update('shipping', id, { status: 'delivered' });
            renderShipping();
        }

        // ==========================================
        // RETURNS
        // ==========================================
        function renderReturns() {
            const returns = Storage.get('returns');
            const tbody = document.getElementById('returnsTableBody');
            
            tbody.innerHTML = returns.map(r => `
                <tr>
                    <td>${formatDate(r.tanggal)}</td>
                    <td>${r.tipe}</td>
                    <td>${r.partner}</td>
                    <td>${r.item}</td>
                    <td>${r.qty}</td>
                    <td>${r.alasan}</td>
                </tr>
            `).join('') || '<tr><td colspan="6" style="text-align: center;">Tidak ada retur</td></tr>';
        }

        function openReturnModal(tipe) {
            const items = Storage.get('items');
            const partners = tipe === 'customer' ? Storage.get('customers') : Storage.get('vendors');
            
            const partnerNama = prompt(`${tipe === 'customer' ? 'Customer' : 'Vendor'}:\n` + partners.map(p => p.nama).join('\n'));
            if(!partnerNama) return;
            
            const itemNama = prompt('Item:\n' + items.map(i => i.nama).join('\n'));
            if(!itemNama) return;
            
            const qty = parseInt(prompt('Qty retur:')) || 0;
            const alasan = prompt('Alasan:') || '';
            
            const retur = {
                id: Date.now().toString(),
                tanggal: new Date().toISOString(),
                tipe: tipe === 'customer' ? 'Retur Customer' : 'Retur Vendor',
                partner: partnerNama,
                item: itemNama,
                qty: qty,
                alasan: alasan
            };
            
            Storage.add('returns', retur);
            
            // Update stock
            const item = items.find(i => i.nama === itemNama);
            if(item) {
                if(tipe === 'customer') item.stok += qty; // Stok masuk
                else item.stok -= qty; // Stok keluar
                Storage.set('items', items);
            }
            
            renderReturns();
            alert('Retur tercatat dan stok diperbarui!');
        }

        // ==========================================
        // FINANCE
        // ==========================================
        function renderFinance() {
            const finance = Storage.get('finance');
            const tbody = document.getElementById('financeTableBody');
            
            tbody.innerHTML = finance.map(f => `
                <tr>
                    <td>${formatDate(f.tanggal)}</td>
                    <td>${f.type === 'income' ? '‚¨ÜÔ∏è Income' : '‚¨áÔ∏è Expense'}</td>
                    <td>${f.kategori}</td>
                    <td>Rp ${f.nominal.toLocaleString()}</td>
                    <td>${f.catatan}</td>
                    <td><button onclick="deleteFinance('${f.id}')" class="danger" style="padding: 5px 10px; font-size: 12px;">üóëÔ∏è</button></td>
                </tr>
            `).join('') || '<tr><td colspan="6" style="text-align: center;">Tidak ada transaksi</td></tr>';
            
            // Profit Loss Report
            const income = finance.filter(f => f.type === 'income').reduce((sum, f) => sum + f.nominal, 0);
            const expense = finance.filter(f => f.type === 'expense').reduce((sum, f) => sum + f.nominal, 0);
            const profit = income - expense;
            
            document.getElementById('profitLossReport').innerHTML = `
                <div class="grid-3" style="text-align: center;">
                    <div style="background: #d4edda; padding: 20px; border-radius: 10px;">
                        <div style="font-size: 24px; font-weight: bold; color: #155724;">Rp ${income.toLocaleString()}</div>
                        <div style="color: #155724;">Total Income</div>
                    </div>
                    <div style="background: #f8d7da; padding: 20px; border-radius: 10px;">
                        <div style="font-size: 24px; font-weight: bold; color: #721c24;">Rp ${expense.toLocaleString()}</div>
                        <div style="color: #721c24;">Total Expense</div>
                    </div>
                    <div style="background: ${profit >= 0 ? '#d1ecf1' : '#f8d7da'}; padding: 20px; border-radius: 10px;">
                        <div style="font-size: 24px; font-weight: bold; color: ${profit >= 0 ? '#0c5460' : '#721c24'};">Rp ${profit.toLocaleString()}</div>
                        <div style="color: ${profit >= 0 ? '#0c5460' : '#721c24'};">${profit >= 0 ? 'Profit' : 'Loss'}</div>
                    </div>
                </div>
            `;
        }

        function openFinanceModal() {
            const type = confirm('Klik OK untuk Income, Cancel untuk Expense') ? 'income' : 'expense';
            const kategori = prompt('Kategori:') || 'Umum';
            const nominal = parseFloat(prompt('Nominal:')) || 0;
            const catatan = prompt('Catatan:') || '';
            
            Storage.add('finance', {
                id: Date.now().toString(),
                tanggal: new Date().toISOString(),
                type: type,
                kategori: kategori,
                nominal: nominal,
                catatan: catatan
            });
            
            renderFinance();
        }

        function deleteFinance(id) {
            if(confirm('Hapus transaksi ini?')) {
                Storage.delete('finance', id);
                renderFinance();
            }
        }

        // ==========================================
        // HR / EMPLOYEES
        // ==========================================
        let employeesData = [];

        function renderEmployees() {
            employeesData = Storage.get('employees');
            const tbody = document.getElementById('employeeTableBody');
            
            if(employeesData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" style="text-align: center; color: #666;">Tidak ada data karyawan. Klik "Tambah Karyawan" untuk memulai.</td></tr>';
                return;
            }
            
            tbody.innerHTML = employeesData.map((emp, index) => {
                const statusClass = emp.isActive ? 'active' : 'inactive';
                const statusText = emp.isActive ? 'Aktif' : 'Non-Aktif';
                
                return `
                    <tr>
                        <td><strong>${emp.nip}</strong></td>
                        <td>${emp.nama}</td>
                        <td>${emp.gender === 'Laki-laki' ? 'üë®' : 'üë©'} ${emp.gender}</td>
                        <td>${emp.unit === 'sales' ? 'üéØ ' : ''}${emp.jabatan}</td>
                        <td><span class="badge ${emp.unit === 'sales' ? 'sales' : ''}">${emp.unit.toUpperCase()}</span></td>
                        <td>${formatDate(emp.tglMasuk)}</td>
                        <td>Rp ${parseFloat(emp.gaji).toLocaleString()}</td>
                        <td><span class="badge ${statusClass}">${statusText}</span></td>
                        <td>
                            <button onclick="editEmployee(${index})" style="padding: 5px 10px; font-size: 12px;">‚úèÔ∏è Edit</button>
                            <button onclick="deleteEmployee(${index})" class="danger" style="padding: 5px 10px; font-size: 12px; margin-left: 5px;">üóëÔ∏è Hapus</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function updateHRStats() {
            const total = employeesData.length;
            const active = employeesData.filter(e => e.isActive).length;
            const inactive = total - active;
            const male = employeesData.filter(e => e.gender === 'Laki-laki').length;
            const female = employeesData.filter(e => e.gender === 'Perempuan').length;
            const salesTeam = employeesData.filter(e => e.unit === 'sales' && e.isActive).length;

            document.getElementById('totalEmployees').textContent = total;
            document.getElementById('activeEmployees').textContent = active;
            document.getElementById('inactiveEmployees').textContent = inactive;
            document.getElementById('totalSales').textContent = salesTeam;
            document.getElementById('maleCount').textContent = male;
            document.getElementById('femaleCount').textContent = female;

            const malePercent = total > 0 ? (male / total * 100).toFixed(1) : 0;
            const femalePercent = total > 0 ? (female / total * 100).toFixed(1) : 0;
            
            document.getElementById('maleBar').style.width = malePercent + '%';
            document.getElementById('maleBar').textContent = male > 0 ? malePercent + '%' : '';
            document.getElementById('femaleBar').style.width = femalePercent + '%';
            document.getElementById('femaleBar').textContent = female > 0 ? femalePercent + '%' : '';

            const resigned = employeesData.filter(e => !e.isActive && e.tglKeluar).length;
            const turnoverRate = total > 0 ? ((resigned / total) * 100).toFixed(2) : 0;
            document.getElementById('turnoverRate').textContent = turnoverRate + '%';

            // Sales contribution
            const sos = Storage.get('sales_orders');
            const totalSales = sos.reduce((sum, so) => sum + (so.total || 0), 0);
            const salesBySalesTeam = totalSales * 0.8;
            document.getElementById('salesContribution').textContent = 'Rp ' + Math.floor(salesBySalesTeam).toLocaleString();
            document.getElementById('salesPercentage').textContent = '80%';
        }

        function filterEmployees() {
            const search = document.getElementById('searchEmployee').value.toLowerCase();
            const status = document.getElementById('filterStatus').value;
            const unit = document.getElementById('filterUnit').value;

            const filtered = employeesData.filter(emp => {
                const matchSearch = emp.nama.toLowerCase().includes(search) || 
                                   emp.nip.toLowerCase().includes(search);
                const matchStatus = !status || (status === 'active' ? emp.isActive : !emp.isActive);
                const matchUnit = !unit || emp.unit === unit;
                return matchSearch && matchStatus && matchUnit;
            });

            const tbody = document.getElementById('employeeTableBody');
            tbody.innerHTML = filtered.map((emp, index) => {
                const originalIndex = employeesData.indexOf(emp);
                const statusClass = emp.isActive ? 'active' : 'inactive';
                const statusText = emp.isActive ? 'Aktif' : 'Non-Aktif';
                
                return `
                    <tr>
                        <td><strong>${emp.nip}</strong></td>
                        <td>${emp.nama}</td>
                        <td>${emp.gender === 'Laki-laki' ? 'üë®' : 'üë©'} ${emp.gender}</td>
                        <td>${emp.unit === 'sales' ? 'üéØ ' : ''}${emp.jabatan}</td>
                        <td><span class="badge ${emp.unit === 'sales' ? 'sales' : ''}">${emp.unit.toUpperCase()}</span></td>
                        <td>${formatDate(emp.tglMasuk)}</td>
                        <td>Rp ${parseFloat(emp.gaji).toLocaleString()}</td>
                        <td><span class="badge ${statusClass}">${statusText}</span></td>
                        <td>
                            <button onclick="editEmployee(${originalIndex})" style="padding: 5px 10px; font-size: 12px;">‚úèÔ∏è Edit</button>
                            <button onclick="deleteEmployee(${originalIndex})" class="danger" style="padding: 5px 10px; font-size: 12px; margin-left: 5px;">üóëÔ∏è Hapus</button>
                        </td>
                    </tr>
                `;
            }).join('') || '<tr><td colspan="9" style="text-align: center;">Tidak ada data</td></tr>';
        }

        function openEmployeeModal() {
            document.getElementById('employeeModal').style.display = 'flex';
            document.getElementById('employeeForm').reset();
            document.getElementById('editIndex').value = '';
            document.getElementById('modalTitle').textContent = 'Tambah Karyawan Baru';
            document.getElementById('tanggalKeluarGroup').style.display = 'none';
        }

        function closeEmployeeModal() {
            document.getElementById('employeeModal').style.display = 'none';
        }

        function toggleTanggalKeluar() {
            const isActive = document.getElementById('isActive').checked;
            document.getElementById('tanggalKeluarGroup').style.display = isActive ? 'none' : 'block';
        }

        function checkSalesUnit() {
            const unit = document.getElementById('unit').value;
            const jabatan = document.getElementById('jabatan');
            if(unit === 'sales' && !jabatan.value.includes('Sales')) {
                jabatan.value = 'Sales ' + (jabatan.value || 'Executive');
            }
        }

        function saveEmployee(e) {
            e.preventDefault();
            
            const employee = {
                nip: document.getElementById('nip').value,
                nama: document.getElementById('nama').value,
                gender: document.getElementById('gender').value,
                tglLahir: document.getElementById('tglLahir').value,
                noWA: document.getElementById('noWA').value,
                email: document.getElementById('email').value,
                tglMasuk: document.getElementById('tglMasuk').value,
                unit: document.getElementById('unit').value,
                jabatan: document.getElementById('jabatan').value,
                gaji: parseFloat(document.getElementById('gaji').value),
                isActive: document.getElementById('isActive').checked,
                tglKeluar: document.getElementById('tglKeluar').value || null
            };

            const editIndex = document.getElementById('editIndex').value;
            
            if(editIndex !== '') {
                employeesData[editIndex] = { ...employeesData[editIndex], ...employee };
            } else {
                if(employeesData.find(emp => emp.nip === employee.nip)) {
                    alert('NIP sudah terdaftar!');
                    return;
                }
                employeesData.push(employee);
            }

            Storage.set('employees', employeesData);
            renderEmployees();
            updateHRStats();
            closeEmployeeModal();
        }

        function editEmployee(index) {
            const emp = employeesData[index];
            document.getElementById('editIndex').value = index;
            document.getElementById('nip').value = emp.nip;
            document.getElementById('nama').value = emp.nama;
            document.getElementById('gender').value = emp.gender;
            document.getElementById('tglLahir').value = emp.tglLahir;
            document.getElementById('noWA').value = emp.noWA;
            document.getElementById('email').value = emp.email;
            document.getElementById('tglMasuk').value = emp.tglMasuk;
            document.getElementById('unit').value = emp.unit;
            document.getElementById('jabatan').value = emp.jabatan;
            document.getElementById('gaji').value = emp.gaji;
            document.getElementById('isActive').checked = emp.isActive;
            document.getElementById('tglKeluar').value = emp.tglKeluar || '';
            
            toggleTanggalKeluar();
            document.getElementById('modalTitle').textContent = 'Edit Data Karyawan';
            document.getElementById('employeeModal').style.display = 'flex';
        }

        function deleteEmployee(index) {
            if(confirm('Yakin ingin menghapus karyawan ini?')) {
                employeesData.splice(index, 1);
                Storage.set('employees', employeesData);
                renderEmployees();
                updateHRStats();
            }
        }

        function exportEmployeesToExcel() {
            const data = employeesData.map(emp => ({
                'NIP': emp.nip,
                'Nama': emp.nama,
                'Jenis Kelamin': emp.gender,
                'Tanggal Lahir': emp.tglLahir,
                'No WA': emp.noWA,
                'Email': emp.email,
                'Tanggal Masuk': emp.tglMasuk,
                'Unit': emp.unit,
                'Jabatan': emp.jabatan,
                'Gaji Pokok': emp.gaji,
                'Status': emp.isActive ? 'Aktif' : 'Non-Aktif',
                'Tanggal Keluar': emp.tglKeluar || '-'
            }));

            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Data Karyawan");
            XLSX.writeFile(wb, "Data_Karyawan_" + new Date().toISOString().split('T')[0] + ".xlsx");
        }

        // ==========================================
        // PAYROLL / SLIP GAJI
        // ==========================================
        let currentPayrollEmployee = null;

        function searchEmployeeForPayroll() {
            const search = document.getElementById('searchPayrollEmployee').value.toLowerCase();
            const resultsDiv = document.getElementById('payrollSearchResults');
            
            if(search.length < 2) {
                resultsDiv.style.display = 'none';
                return;
            }

            const matches = employeesData.filter(emp => 
                emp.isActive && (
                    emp.nama.toLowerCase().includes(search) || 
                    emp.nip.toLowerCase().includes(search)
                )
            );

            if(matches.length > 0) {
                resultsDiv.innerHTML = matches.map(emp => `
                    <div class="search-result-item" onclick="selectEmployeeForPayroll('${emp.nip}')">
                        <strong>${emp.nama}</strong> (${emp.nip})<br>
                        <small>${emp.jabatan} - ${emp.unit}</small>
                    </div>
                `).join('');
                resultsDiv.style.display = 'block';
            } else {
                resultsDiv.innerHTML = '<div class="search-result-item">Tidak ada karyawan ditemukan</div>';
                resultsDiv.style.display = 'block';
            }
        }

        function selectEmployeeForPayroll(nip) {
            const emp = employeesData.find(e => e.nip === nip);
            if(!emp) return;

            currentPayrollEmployee = emp;
            document.getElementById('payrollSearchResults').style.display = 'none';
            document.getElementById('searchPayrollEmployee').value = emp.nama + ' (' + emp.nip + ')';
            document.getElementById('payrollForm').style.display = 'block';

            document.getElementById('payrollName').textContent = emp.nama;
            document.getElementById('payrollNIP').textContent = emp.nip;
            document.getElementById('payrollUnit').textContent = emp.unit.toUpperCase();
            document.getElementById('payrollPosition').textContent = emp.jabatan;
            document.getElementById('payrollBasicSalary').textContent = 'Rp ' + parseFloat(emp.gaji).toLocaleString();
            
            document.getElementById('pokok').value = 'Rp ' + parseFloat(emp.gaji).toLocaleString();
            document.getElementById('slipUnitText').textContent = emp.unit.toUpperCase();
            
            calculatePayroll();
        }

        function calculatePayroll() {
            if(!currentPayrollEmployee) return;

            const pokok = parseFloat(currentPayrollEmployee.gaji);
            const tunjanganJabatan = parseFloat(document.getElementById('tunjanganJabatan').value) || 0;
            const perjalananDinas = parseFloat(document.getElementById('perjalananDinas').value) || 0;
            const lembur = parseFloat(document.getElementById('lembur').value) || 0;

            const potonganAbsen = parseFloat(document.getElementById('potonganAbsen').value) || 0;
            const potonganTerlambat = parseFloat(document.getElementById('potonganTerlambat').value) || 0;
            const potonganPulangCepat = parseFloat(document.getElementById('potonganPulangCepat').value) || 0;
            const potonganBon = parseFloat(document.getElementById('potonganBon').value) || 0;
            const potonganSeragam = parseFloat(document.getElementById('potonganSeragam').value) || 0;
            const potonganBPJS = parseFloat(document.getElementById('potonganBPJS').value) || 0;

            const gajiKotor = pokok + tunjanganJabatan + perjalananDinas + lembur;
            const totalPotongan = potonganAbsen + potonganTerlambat + potonganPulangCepat + potonganBon + potonganSeragam + potonganBPJS;
            const totalGaji = gajiKotor - totalPotongan;

            document.getElementById('gajiKotor').value = 'Rp ' + gajiKotor.toLocaleString();
            document.getElementById('totalPotongan').value = 'Rp ' + totalPotongan.toLocaleString();
            document.getElementById('totalGaji').textContent = 'Rp ' + totalGaji.toLocaleString();
        }

        function generateSlipPreview() {
            if(!currentPayrollEmployee) {
                alert('Pilih karyawan terlebih dahulu!');
                return;
            }

            document.getElementById('slipPreview').style.display = 'block';
            
            document.getElementById('slipUnitText').textContent = document.getElementById('payrollUnit').textContent;
            document.getElementById('slipAddress').textContent = document.getElementById('payrollAddress').value;
            document.getElementById('slipPeriod').textContent = document.getElementById('payrollPeriod').value;
            
            document.getElementById('slipName').textContent = currentPayrollEmployee.nama;
            document.getElementById('slipPosition').textContent = currentPayrollEmployee.jabatan;
            document.getElementById('slipNIP').textContent = currentPayrollEmployee.nip;

            document.getElementById('slipPokok').textContent = document.getElementById('pokok').value;
            document.getElementById('slipTunjanganJabatan').textContent = 'Rp ' + (parseFloat(document.getElementById('tunjanganJabatan').value) || 0).toLocaleString();
            document.getElementById('slipPerjalananDinas').textContent = 'Rp ' + (parseFloat(document.getElementById('perjalananDinas').value) || 0).toLocaleString();
            document.getElementById('slipLembur').textContent = 'Rp ' + (parseFloat(document.getElementById('lembur').value) || 0).toLocaleString();
            document.getElementById('slipGajiKotor').textContent = document.getElementById('gajiKotor').value;

            document.getElementById('slipPotonganAbsen').textContent = 'Rp ' + (parseFloat(document.getElementById('potonganAbsen').value) || 0).toLocaleString();
            document.getElementById('slipPotonganTerlambat').textContent = 'Rp ' + (parseFloat(document.getElementById('potonganTerlambat').value) || 0).toLocaleString();
            document.getElementById('slipPotonganPulangCepat').textContent = 'Rp ' + (parseFloat(document.getElementById('potonganPulangCepat').value) || 0).toLocaleString();
            document.getElementById('slipPotonganBon').textContent = 'Rp ' + (parseFloat(document.getElementById('potonganBon').value) || 0).toLocaleString();
            document.getElementById('slipPotonganSeragam').textContent = 'Rp ' + (parseFloat(document.getElementById('potonganSeragam').value) || 0).toLocaleString();
            document.getElementById('slipPotonganBPJS').textContent = 'Rp ' + (parseFloat(document.getElementById('potonganBPJS').value) || 0).toLocaleString();
            document.getElementById('slipTotalPotongan').textContent = document.getElementById('totalPotongan').value;
            document.getElementById('slipTotalGaji').textContent = document.getElementById('totalGaji').textContent;

            document.getElementById('slipPreview').scrollIntoView({ behavior: 'smooth' });
        }

        function exportPayrollToExcel() {
            if(!currentPayrollEmployee) {
                alert('Pilih karyawan terlebih dahulu!');
                return;
            }

            const period = document.getElementById('payrollPeriod').value || 'Slip_Gaji';
            const filename = `Slip_Gaji_${currentPayrollEmployee.nama}_${period}`.replace(/\s+/g, '_');

            const data = [
                ['SLIP GAJI BULANAN'],
                [''],
                ['UNIT', document.getElementById('payrollUnit').textContent],
                [document.getElementById('payrollAddress').value],
                [''],
                ['Periode', document.getElementById('payrollPeriod').value],
                ['Nama', currentPayrollEmployee.nama],
                ['Jabatan', currentPayrollEmployee.jabatan],
                ['NIP', currentPayrollEmployee.nip],
                [''],
                ['PENERIMAAN', '', 'POTONGAN', ''],
                ['Gaji Pokok', document.getElementById('pokok').value, 'Tidak Masuk Kerja', 'Rp ' + (parseFloat(document.getElementById('potonganAbsen').value) || 0).toLocaleString()],
                ['Tunjangan Jabatan', 'Rp ' + (parseFloat(document.getElementById('tunjanganJabatan').value) || 0).toLocaleString(), 'Terlambat', 'Rp ' + (parseFloat(document.getElementById('potonganTerlambat').value) || 0).toLocaleString()],
                ['Perjalanan Dinas', 'Rp ' + (parseFloat(document.getElementById('perjalananDinas').value) || 0).toLocaleString(), 'Pulang Cepat / Izin 1/2 Hari', 'Rp ' + (parseFloat(document.getElementById('potonganPulangCepat').value) || 0).toLocaleString()],
                ['Lembur', 'Rp ' + (parseFloat(document.getElementById('lembur').value) || 0).toLocaleString(), 'Potongan Bon', 'Rp ' + (parseFloat(document.getElementById('potonganBon').value) || 0).toLocaleString()],
                ['', '', 'Potongan Seragam', 'Rp ' + (parseFloat(document.getElementById('potonganSeragam').value) || 0).toLocaleString()],
                ['', '', 'Potongan BPJS', 'Rp ' + (parseFloat(document.getElementById('potonganBPJS').value) || 0).toLocaleString()],
                [''],
                ['Gaji Kotor', document.getElementById('gajiKotor').value, 'Total Potongan', document.getElementById('totalPotongan').value],
                [''],
                ['TOTAL GAJI YANG DITERIMA', document.getElementById('totalGaji').textContent],
                [''],
                ['Dibuat Oleh:', '', 'Diterima Oleh:'],
                ['HRD', '', 'Karyawan']
            ];

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Slip Gaji");
            XLSX.writeFile(wb, filename + ".xlsx");
        }

        function printSlip() {
            if(document.getElementById('slipPreview').style.display === 'none') {
                generateSlipPreview();
            }
            window.print();
        }

        function resetPayroll() {
            document.getElementById('searchPayrollEmployee').value = '';
            document.getElementById('payrollForm').style.display = 'none';
            document.getElementById('slipPreview').style.display = 'none';
            document.getElementById('payrollPeriod').value = '';
            document.getElementById('payrollAddress').value = '';
            
            ['tunjanganJabatan', 'perjalananDinas', 'lembur', 'potonganAbsen', 'potonganTerlambat', 
             'potonganPulangCepat', 'potonganBon', 'potonganSeragam', 'potonganBPJS'].forEach(id => {
                document.getElementById(id).value = 0;
            });
            
            currentPayrollEmployee = null;
        }

        // ==========================================
        // UTILITIES
        // ==========================================
        function formatDate(dateString) {
            if(!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID');
        }

        // Close modal on outside click
        window.onclick = function(event) {
            if(event.target === document.getElementById('employeeModal')) {
                closeEmployeeModal();
            }
        }
    </script>
</body>
</html>
